<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SIAP LIBAS ASPD DIY SD | Mafia Quiz</title>
    
    <style>
        /* --- RESET & VARIABLES --- */
        
    :root {
        --bg-dark: #0f172a;
        --primary: #6366f1;
        --primary-hover: #4f46e5;
        --accent: #d4af37;
        --success: #10b981;
        --danger: #ef4444;
        --warning: #f59e0b;
        --text-main: #ffffff;
        --text-muted: #94a3b8;
        --glass-bg: rgba(30, 41, 59, 0.7);
        --glass-border: rgba(255, 255, 255, 0.1);
        --card-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
  

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif; -webkit-tap-highlight-color: transparent; }
        html { height: 100%; }
        body { background-color: var(--bg-dark); color: var(--text-main); height: 100dvh; width: 100vw; display: flex; flex-direction: column; overflow: hidden; position: fixed; }

        /* --- LAYOUT --- */
        header { flex: 0 0 60px; background: rgba(15, 23, 42, 0.95); border-bottom: 1px solid var(--glass-border); backdrop-filter: blur(5px); display: flex; align-items: center; justify-content: space-between; padding: 0 1rem; z-index: 40; }
        main { flex: 1; overflow-y: auto; position: relative; padding: 1rem; display: flex; flex-direction: column; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; }
        footer { flex: 0 0 auto; background: rgba(15, 23, 42, 0.95); border-top: 1px solid var(--glass-border); backdrop-filter: blur(5px); padding: 0.75rem 1rem; z-index: 40; }

        /* --- COMPONENTS --- */
        .card-container { width: 100%; max-width: 800px; margin: 0 auto; flex: 1; display: flex; flex-direction: column; }
        .glass { background: var(--glass-bg); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid var(--glass-border); box-shadow: var(--card-shadow); }
        #questionCard { border-radius: 1rem; padding: 1.25rem; display: flex; flex-direction: column; min-height: auto; flex-grow: 1; animation: fadein 0.3s ease-out; }
        @keyframes fadein { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h2#qText { font-size: 1.1rem; line-height: 1.5; margin-bottom: 1rem; font-weight: 600; }
        @media (min-width: 768px) { h2#qText { font-size: 1.35rem; } }
        
        /* Global Image Safety */
        img { max-width: 100%; height: auto; display: inline-block; }
        
        button, a.btn { cursor: pointer; border: none; outline: none; transition: all 0.2s; user-select: none; text-decoration: none; }
        button:active, a.btn:active { transform: scale(0.98); }
        
        .btn { padding: 0.75rem 1rem; border-radius: 0.75rem; font-weight: 600; display: inline-flex; align-items: center; justify-content: center; color: white; font-size: 0.9rem; }
        .btn-primary { background: linear-gradient(to right, var(--primary), var(--accent)); box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3); }
        .btn-nav { background: #334155; color: white; border: 1px solid rgba(255,255,255,0.1); }
        .btn-finish { background: var(--success); }
        .btn-success { background: #25D366; color: white; }
        .btn-outline { border: 1px solid var(--primary); color: var(--primary); background: transparent; }

        .btn-option { width: 100%; text-align: left; padding: 0.85rem; border-radius: 0.75rem; background: rgba(30, 41, 59, 0.5); border: 1px solid var(--glass-border); color: var(--text-muted); margin-bottom: 0.5rem; display: flex; align-items: center; font-size: 0.9rem; }
        .btn-option:active, .btn-option:hover { background: rgba(50, 60, 80, 0.8); border-color: var(--primary); color: white; }
        .btn-option.correct { background: rgba(16, 185, 129, 0.15); border-color: var(--success); color: #a7f3d0; }
        .btn-option.wrong { background: rgba(239, 68, 68, 0.15); border-color: var(--danger); color: #fca5a5; }
        .btn-option.missed { border: 1px dashed var(--success); opacity: 0.7; }
        
        .option-icon { margin-right:10px; border:1px solid currentColor; border-radius:50%; width:20px; height:20px; display:flex; align-items:center; justify-content:center; font-size:0.7rem; font-weight:bold; flex-shrink: 0; }
        .btn-option.checkbox .option-icon { border-radius: 4px; } 

        textarea, input, select { width: 100%; background: rgba(15, 23, 42, 0.8); border: 1px solid rgba(139, 92, 246, 0.3); color: white; padding: 0.75rem; border-radius: 0.5rem; font-size: 0.9rem; }
        .match-row { background: rgba(30, 41, 59, 0.4); padding: 0.75rem; border-radius: 0.5rem; margin-bottom: 0.5rem; border: 1px solid var(--glass-border); }
        
        /* Effects */
        .blob { position: absolute; border-radius: 50%; filter: blur(60px); opacity: 0.2; z-index: -1; animation: pulse 6s infinite ease-in-out; }
        .blob-1 { top: -10%; left: -10%; width: 300px; height: 300px; background: var(--primary); }
        .blob-2 { bottom: -10%; right: -10%; width: 250px; height: 250px; background: var(--accent); animation-delay: 3s; }
        @keyframes pulse { 0%, 100% { opacity: 0.15; transform: scale(1); } 50% { opacity: 0.25; transform: scale(1.1); } }

        .confetti { position: fixed; width: 10px; height: 10px; background-color: #f00; animation: fall linear forwards; z-index: 60; }
        @keyframes fall { to { transform: translateY(100vh) rotate(720deg); } }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100dvh; background: rgba(0, 0, 0, 0.9); z-index: 50; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 1rem; overflow-y: auto; }
        .modal-content { width: 100%; max-width: 400px; border-radius: 1rem; padding: 1.5rem; border-top: 4px solid var(--primary); margin: auto; }

        .badge { font-size: 0.65rem; padding: 0.2rem 0.6rem; border-radius: 20px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; border: 1px solid; }
        .badge-pg { background: rgba(59, 130, 246, 0.1); color: #93c5fd; border-color: rgba(59, 130, 246, 0.3); }
        .badge-complex { background: rgba(236, 72, 153, 0.1); color: #fbcfe8; border-color: rgba(236, 72, 153, 0.3); }
        .badge-match { background: rgba(20, 184, 166, 0.1); color: #5eead4; border-color: rgba(20, 184, 166, 0.3); }
        .badge-mix { background: rgba(168, 85, 247, 0.1); color: #d8b4fe; border-color: rgba(168, 85, 247, 0.3); }

        .map-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 0.5rem; }
        .map-btn { aspect-ratio: 1; background: #334155; border-radius: 0.35rem; color: #94a3b8; font-weight: bold; font-size: 0.8rem; }
        .map-btn.active { background: var(--primary); color: white; border: 1px solid white; }
        .map-btn.answered { background: var(--success); color: #064e3b; }

        .hidden { display: none !important; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .justify-between { justify-content: space-between; }
        .gap-2 { gap: 0.5rem; }
        .text-center { text-align: center; }

        .wa-banner { background: linear-gradient(90deg, #064e3b, #065f46); padding: 0.5rem 0.75rem; border-radius: 0.5rem; display: flex; align-items: center; justify-content: space-between; color: white; text-decoration: none; border: 1px solid #047857; margin-top: 0.5rem; }
    </style>

</head>
<body>

    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>

    <!-- START MODAL -->
    <div id="startModal" class="modal-overlay">
        <div class="glass modal-content">
            <div class="text-center mb-4">
                
                   <div style="width: 80px; height: 80px; background: linear-gradient(135deg, var(--primary), var(--accent)); border-radius: 20px; display: inline-flex; align-items: center; justify-content: center; box-shadow: 0 12px 24px rgba(0,0,0,0.4); transform: rotate(-5deg);">
                        <span style="color: white; font-weight: 900; font-size: 2rem; transform: rotate(5deg);">MQ</span>
                   </div>
                
            </div>
            <div style="text-align: center; margin-bottom: 0.5rem;">
                <span style="background: var(--accent); color: black; padding: 2px 10px; border-radius: 4px; font-weight: 900; font-size: 0.7rem; letter-spacing: 2px; text-transform: uppercase;">Mafia Quiz</span>
            </div>
            <h1 style="font-size: 1.75rem; font-weight: 900; text-align: center; margin-bottom: 0.25rem; background: -webkit-linear-gradient(0deg, var(--primary), var(--accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; line-height: 1.1;">SIAP LIBAS ASPD DIY SD</h1>
            <p style="text-align: center; color: var(--text-muted); font-size: 0.9rem; letter-spacing: 1px; margin-bottom: 1.5rem; font-weight: 600;">Level 2: Laboratorium Sains</p>
            
            <div style="background: rgba(15,23,42,0.5); padding: 1.25rem; border-radius: 1rem; font-size: 0.85rem; border: 1px solid rgba(255,255,255,0.05); margin-bottom: 1.5rem; box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);">
                <div class="flex justify-between" style="border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 0.6rem; margin-bottom: 0.6rem;">
                    <span style="color:var(--text-muted)">Durasi</span> <b style="color: white;">120 Menit</b>
                </div>
                <div class="flex justify-between" style="border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 0.6rem; margin-bottom: 0.6rem;">
                    <span style="color:var(--text-muted)">Jumlah Soal</span> <b style="color: white;">35 Butir</b>
                </div>
                <div class="flex flex-col" style="gap: 4px;">
                    <span style="color:var(--text-muted); font-size: 0.8rem;">Variasi Soal:</span> <b style="color: var(--accent); font-size: 0.8rem; text-transform: uppercase;">35 PG</b>
                </div>
            </div>
            
            <button id="btnStartQuiz" class="btn btn-primary" style="width: 100%; font-size: 1.1rem; padding: 1rem; border-radius: 1rem;">
                MULAI SEKARANG
            </button>
            <a href="https://wa.me/6285643573687?text=Halo%20Mafia%20Quiz%2C%20saya%20ingin%20memesan%20aplikasi%20kuis%20interaktif%20seperti%20%22SIAP%20LIBAS%20ASPD%20DIY%20SD%22." target="_blank" rel="noopener noreferrer" class="btn btn-success" style="width: 100%; font-size: 0.9rem; margin-top: 0.75rem; border: 1px solid #4ade80; padding: 0.85rem; border-radius: 1rem;">
                PESAN KUIS @ MAFIA QUIZ
            </a>
            <p style="text-align: center; font-size: 0.65rem; color: var(--text-muted); margin-top: 1.25rem; opacity: 0.6; font-weight: 800; letter-spacing: 1px; white-space: nowrap;">POWERED BY MAFIA QUIZ CORE SYSTEM</p>
        </div>
    </div>

    <!-- APP CONTAINER -->
    <div id="appContainer" class="hidden" style="width: 100%; height: 100%; flex-direction: column;">
        
        <!-- BIG PROMINENT HEADER -->
        <header style="height: 60px; padding: 0 1rem;">
            <div style="display: flex; align-items: center;">
                
                   <div style="background: linear-gradient(135deg, var(--primary), var(--accent)); width:36px; height:36px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-weight:900; font-size:0.9rem; color:white; box-shadow: 0 4px 10px rgba(0,0,0,0.4); transform: rotate(-3deg); margin-right: 12px;">
                      <span style="transform: rotate(3deg);">MQ</span>
                   </div>
                
                <div class="flex-col" style="gap: 0;">
                  <span style="font-weight:900; font-size:0.9rem; line-height:1; letter-spacing: -0.5px; color: white; white-space: nowrap;">MAFIA QUIZ</span>
                  <span style="font-size: 0.55rem; color: var(--accent); font-weight: 800; letter-spacing: 2px; white-space: nowrap;">CORE SYSTEM</span>
                </div>
            </div>
            
            <div style="background:rgba(0,0,0,0.5); padding:0.25rem 0.75rem; border-radius:8px; border:1px solid rgba(255,255,255,0.1); display:flex; align-items:center; box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);">
                <span id="timerDisplay" style="font-family:monospace; font-weight:900; font-size:0.9rem; color:var(--warning); letter-spacing: 1px;">00:00:00</span>
            </div>

            <button onclick="toggleMap()" style="background:rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color:var(--text-muted); padding:0.4rem; border-radius: 10px; position:relative; display: flex; align-items: center; justify-content: center;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z"/></svg>
                <span id="answeredCount" style="position:absolute; top:-4px; right:-4px; background:var(--success); color:black; font-size:9px; font-weight:900; width:16px; height:16px; border-radius:5px; display:flex; align-items:center; justify-content:center; border: 2px solid var(--bg-dark);">0</span>
            </button>
        </header>

        <div id="mapModal" class="modal-overlay hidden" style="z-index: 45;">
            <div class="glass modal-content" style="max-width: 340px; padding: 2rem;">
                <div class="flex justify-between align-center mb-6">
                    <h3 style="font-weight:900; font-size: 1.3rem; letter-spacing: -1px; color: white;">NAVIGASI SOAL</h3>
                    <button onclick="toggleMap()" style="background:rgba(239,68,68,0.1); border: 1px solid var(--danger); color:var(--danger); width:32px; height:32px; border-radius: 8px; font-weight: 900;">âœ•</button>
                </div>
                <div id="mapGrid" class="map-grid" style="gap: 0.75rem;"></div>
                <div style="margin-top: 2rem; text-align: center; font-size: 0.65rem; color: var(--text-muted); font-weight: 900; letter-spacing: 3px; opacity: 0.5;">MAFIA QUIZ NAVCORE</div>
            </div>
        </div>

        <main style="padding: 1.5rem 1rem;">
            <div class="card-container">
                <div style="height:6px; background:rgba(255,255,255,0.05); border-radius:3px; margin-bottom:1.5rem; width:100%; position: relative; overflow: hidden;">
                    <div id="progressBar" style="height:100%; background: linear-gradient(to right, var(--primary), var(--accent)); width:0%; border-radius:3px; transition:width 0.5s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 0 10px var(--primary);"></div>
                </div>

                <div id="questionCard" class="glass" style="padding: 2rem; border-radius: 1.5rem;">
                    <div class="flex justify-between align-center mb-6">
                        <span id="qTypeBadge" class="badge badge-pg" style="padding: 0.4rem 1rem; font-size: 0.75rem;">PG</span>
                        <div style="text-align: right;">
                           <span id="qNumber" style="font-family:monospace; color:var(--text-muted); font-size:0.9rem; font-weight: 900; background: rgba(0,0,0,0.2); padding: 0.2rem 0.6rem; border-radius: 6px;">1 / 35</span>
                        </div>
                    </div>

                    <h2 id="qText" style="font-size: 1.4rem; font-weight: 800; margin-bottom: 2rem; color: white;" dir="auto">...</h2>
                    <div id="qContent" style="display:flex; flex-direction:column; gap:0.75rem;"></div>

                    <div id="feedbackContainer" class="hidden" style="margin-top:2rem; padding:1.25rem; border-radius:1rem; background:rgba(15,23,42,0.8); border-left:6px solid var(--warning); font-size:0.9rem; line-height:1.6; box-shadow: 0 4px 12px rgba(0,0,0,0.2);">
                        <b style="display:block; margin-bottom:0.5rem; color: var(--warning); font-weight: 900; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1.5px;">ðŸ”‘ PEMBAHASAN:</b>
                        <span id="feedbackText" style="color: #cbd5e1;" dir="auto"></span>
                    </div>
                </div>
            </div>
        </main>

        <footer style="padding: 0.75rem;">
            <div class="card-container">
                <div class="flex justify-between gap-3" style="margin-bottom: 0.75rem;">
                    <button id="btnPrev" onclick="prevQ()" class="btn btn-nav" style="flex:1; padding: 0.75rem; border-radius: 10px; font-weight: 800; font-size: 0.85rem;" disabled>KEMBALI</button>
                    <button id="btnNext" onclick="nextQ()" class="btn btn-primary" style="flex:2; padding: 0.75rem; border-radius: 10px; font-weight: 900; font-size: 0.9rem; letter-spacing: 1px;">LANJUT</button>
                    <button id="btnFinish" onclick="finishQuiz()" class="btn btn-finish hidden" style="flex:2; padding: 0.75rem; border-radius: 10px; font-weight: 900; font-size: 0.9rem; letter-spacing: 1px;">SELESAI</button>
                </div>
                
                <a href="https://wa.me/6285643573687?text=Halo%20Admin%20Mafia%20Quiz%2C%20saya%20tertarik%20membuat%20aplikasi%20kuis%20untuk%20materi%20lain." class="wa-banner" target="_blank" rel="noopener noreferrer" style="padding: 0.6rem 0.75rem; border-radius: 0.75rem; background: linear-gradient(135deg, #064e3b, #065f46); border: 1px solid #059669; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                    <div style="display: flex; align-items: center;">
                        <div style="background: #22c55e; width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 8px rgba(0,0,0,0.2); margin-right: 12px;">
                           <svg width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M16.75 13.96c.25.13.36.25.36.43 0 .12-.05.22-.11.25-.21.28-1.05.65-1.39.75-.41.11-.79.17-1.14.17-.62 0-1.29-.18-1.92-.51-.43-.22-1.03-.66-1.74-1.25-1.04-.88-1.83-1.86-2.29-2.84-.15-.32-.23-.65-.23-.96 0-.41.17-.77.51-1.11.16-.15.35-.24.51-.24.16 0 .32.06.45.2.16.17.55 1.13.6 1.25.06.15.09.28.09.4 0 .15-.06.28-.18.42l-.28.3c-.09.11-.19.24-.09.43.32.55.9 1.28 1.68 1.98.66.59 1.34.98 1.86 1.17.16.06.32.08.46.08.28 0 .58-.15.78-.39l.34-.42c.15-.17.32-.23.5-.17zM12.05 2.05C6.58 2.05 2.13 6.5 2.13 11.97c0 1.76.46 3.4 1.26 4.83l-1.33 4.86 4.98-1.3c1.39.76 2.97 1.18 4.61 1.18 5.47 0 9.92-4.45 9.92-9.92 0-5.47-4.45-9.92-9.52-9.57z"/></svg>
                        </div>
                        <div class="flex-col" style="line-height: 1.1;">
                            <span style="font-size:0.55rem; color:#86efac; font-weight:900; letter-spacing: 1.5px; text-transform: uppercase; white-space: nowrap;">REQUEST MATERI LAIN?</span>
                            <span style="font-size:0.85rem; font-weight:800; color: white; white-space: nowrap;">Hubungi Admin Mafia Quiz</span>
                        </div>
                    </div>
                </a>
                <div style="text-align: center; margin-top: 0.75rem; font-size: 0.55rem; font-weight: 900; color: var(--accent); letter-spacing: 5px; opacity: 0.4;">MAFIA QUIZ PREMIUM INTERACTIVE ASSET</div>
            </div>
        </footer>
    </div>

    <!-- RESULT MODAL -->
    <div id="resultModal" class="modal-overlay hidden">
        <div class="glass modal-content" style="padding: 2.5rem 2rem;">
            <div style="text-align: center; margin-bottom: 1rem;">
               
                   <span style="background: var(--accent); color: black; padding: 4px 12px; border-radius: 6px; font-weight: 900; font-size: 0.7rem; letter-spacing: 2.5px;">MAFIA QUIZ</span>
               
            </div>
            <h2 style="font-size:1.75rem; text-align:center; margin-bottom:0.25rem; font-weight: 900; color: white; letter-spacing: -0.5px;">HASIL EVALUASI</h2>
            <p style="text-align:center; color:var(--text-muted); font-size:0.9rem; margin-bottom:2rem; font-weight: 600;">Level 2: Laboratorium Sains</p>
            
            <div class="flex gap-3 mb-6">
                <div style="flex:1.2; background:rgba(15,23,42,0.8); padding:1.5rem 1rem; border-radius:1rem; text-align:center; border: 2px solid var(--primary); box-shadow: 0 8px 20px rgba(0,0,0,0.4);">
                    <div style="font-size:0.7rem; color:var(--text-muted); text-transform:uppercase; font-weight: 900; letter-spacing: 1.5px; margin-bottom: 0.25rem;">SKOR AKHIR</div>
                    <div id="finalScore" style="font-size:3rem; font-weight:900; color:var(--primary); line-height: 1; text-shadow: 0 0 15px var(--primary);">0</div>
                </div>
                <div style="flex:1; background:rgba(15,23,42,0.8); padding:1.5rem 1rem; border-radius:1rem; text-align:center; border: 1px solid rgba(255,255,255,0.1); display: flex; flex-direction: column; justify-content: center;">
                    <div style="font-size:0.7rem; color:var(--text-muted); text-transform:uppercase; font-weight: 900; letter-spacing: 1.5px; margin-bottom: 0.25rem;">STATUS</div>
                    <div id="finalPred" style="font-size:1rem; font-weight:900; color:white; line-height: 1.2;">-</div>
                </div>
            </div>

            <div style="font-size:0.9rem; margin-bottom:2rem; background: rgba(0,0,0,0.3); padding: 1.25rem; border-radius: 1rem; border: 1px solid rgba(255,255,255,0.05); box-shadow: inset 0 2px 8px rgba(0,0,0,0.3);">
                <div class="flex justify-between py-2" style="border-bottom:1px solid rgba(255,255,255,0.05);">
                    <span style="color:var(--text-muted); font-weight: 700;">Jawaban Benar</span> <b id="resCorrect" style="color:var(--success); font-size: 1.1rem;">0</b>
                </div>
                <div class="flex justify-between py-2" style="border-bottom:1px solid rgba(255,255,255,0.05);">
                    <span style="color:var(--text-muted); font-weight: 700;">Jawaban Salah</span> <b id="resWrong" style="color:var(--danger); font-size: 1.1rem;">0</b>
                </div>
                <div class="flex justify-between py-2">
                    <span style="color:var(--text-muted); font-weight: 700;">Poin Esai</span> <b id="resEssay" style="color:#60a5fa; font-size: 1.1rem;">0</b>
                </div>
            </div>
            
            <div class="flex gap-3">
                <button onclick="location.reload()" class="btn btn-nav" style="flex:1; font-weight: 900; padding: 1rem; border-radius: 12px;">COBA LAGI</button>
                <button id="btnShareApp" class="btn btn-primary" style="flex:1.5; font-weight: 900; gap: 10px; padding: 1rem; border-radius: 12px; font-size: 1rem;">
                   BAGIKAN HASIL <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                </button>
            </div>
            
            <a href="https://wa.me/6285643573687?text=Halo%20Mafia%20Quiz%2C%20saya%20baru%20saja%20menyelesaikan%20kuis%20%22SIAP%20LIBAS%20ASPD%20DIY%20SD%22%20dan%20ingin%20memesan%20kuis%20serupa." target="_blank" rel="noopener noreferrer" class="btn btn-success" style="width:100%; margin-top: 15px; font-size: 0.95rem; border: 1px solid #4ade80; font-weight: 900; padding: 1rem; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);">
                PESAN KUIS SERUPA @ MAFIA QUIZ
            </a>
            <div style="margin-top: 2rem; text-align: center; font-size: 0.65rem; color: var(--text-muted); font-weight: 800; letter-spacing: 2px; opacity: 0.4;">
              &copy; 2026 MAFIA QUIZ - PREMIUM INTERACTIVE ASSET
            </div>
        </div>
    </div>
    
    
    <script>
        
    const quizData = [{"id":1,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#0984e3;'>[DATA HUBUNGAN MAKHLUK HIDUP]</strong><br><br><table border='1' style='width:100%; border-collapse:collapse; text-align:left; border-color:#ccc;'> <tr style='background:#dfe6e9;'><th>No</th><th>Interaksi</th><th>Simbiosis</th></tr> <tr><td>1</td><td>Binahong merambat di pohon rambutan</td><td>(A) Mutualisme</td></tr> <tr><td>2</td><td>Bakteri E.coli di usus besar manusia</td><td>(B) Parasitisme</td></tr> <tr><td>3</td><td>Jamur penisilin dan bakteri kudis</td><td>(C) Komensalisme</td></tr> <tr><td>4</td><td>Benalu menempel di pohon inang</td><td>(D) Amensalisme</td></tr></table><br><strong style='font-size:1.1em; color:#000;'>Pasangan interaksi dan jenis simbiosis yang tepat adalah...</strong></div>","options":{"A":"1-C (Binahong - Komensalisme)","B":"2-D (E.coli - Amensalisme)","C":"3-A (Jamur - Mutualisme)","D":"4-B (Benalu - Parasitisme)"},"answer":"D","explanation":"Benalu mengambil sari makanan dari pohon inang (Parasitisme). Binahong hanya menumpang (Komensalisme). Bakteri E.coli membantu pembusukan (Mutualisme). Jamur Penicillium menghambat bakteri (Amensalisme)."},{"id":2,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Di kebun sekolah terdapat tanaman jambu, ulat, burung kutilang, dan ular.</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Rantai makanan yang terbentuk dalam ekosistem tersebut adalah...</strong></div>","options":{"A":"jambu -> ulat -> burung kutilang -> ular","B":"jambu -> burung kutilang -> ulat -> ular","C":"ulat -> jambu -> burung kutilang -> ular","D":"ular -> burung kutilang -> ulat -> jambu"},"answer":"A","explanation":"Produsen (Jambu) dimakan Konsumen I (Ulat). Ulat dimakan Konsumen II (Burung Kutilang). Burung dimakan Konsumen III (Ular)."},{"id":3,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#27ae60;'>[CARA ADAPTASI HEWAN]</strong><br>â€¢ Kelompok 1: Kaki seribu & Ulat gagak (Menggulungkan tubuh)<br>â€¢ Kelompok 2: Bunglon & Katak (Lidah panjang & lengket)<br>â€¢ Kelompok 3: Cecak & Kecoak (....?)<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Cara adaptasi yang tepat untuk melengkapi Kelompok 3 adalah...</strong></div>","options":{"A":"Mengeluarkan bau menyengat","B":"Memutuskan ekor (autotomi)","C":"Pura-pura mati","D":"Mengubah warna kulit"},"answer":"B","explanation":"Cecak melakukan autotomi (putus ekor). Namun, jika pasangannya Kecoak (yang lazimnya pura-pura mati atau lari cepat), opsi yang paling umum untuk Cecak adalah Autotomi. *Catatan: Pada kunci P4, Kecoak & Kumbang dikelompokkan 'pura-pura mati'.*"},{"id":4,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#27ae60;'>[TABEL ADAPTASI TUMBUHAN]</strong><br><table border='1' style='width:100%; border-collapse:collapse; text-align:left; border-color:#ccc;'> <tr><td>(1) Kaktus</td><td>Daun berbentuk duri</td></tr> <tr><td>(2) Bakau</td><td>Akar napas</td></tr> <tr><td>(3) Eceng Gondok</td><td>Batang berongga</td></tr> <tr><td>(4) Jati</td><td>Menggugurkan daun (meranggas)</td></tr></table><br><strong style='font-size:1.1em; color:#000;'>Pasangan tumbuhan dan tujuan adaptasinya yang benar:</strong><br>A. (1) mengurangi penguapan, (2) mengambil oksigen<br>B. (2) menopang tubuh, (3) mengapung di air<br>C. (3) menyimpan air, (4) mengurangi penguapan</div>","options":{"A":"A","B":"B","C":"C","D":"Semua benar"},"answer":"A","explanation":"Kaktus daun duri = kurangi penguapan. Bakau akar napas = ambil oksigen. Eceng gondok batang berongga = mengapung/saluran udara. Jati meranggas = kurangi penguapan."},{"id":5,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Pemerintah melarang penggunaan pukat harimau (jaring besar) untuk menangkap ikan di laut.</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Dampak negatif jika pelarangan tersebut dilanggar adalah...</strong></div>","options":{"A":"Populasi ikan kecil meningkat drastis","B":"Merusak terumbu karang dan menjaring ikan kecil yang belum layak tangkap","C":"Air laut menjadi keruh dan tercemar limbah","D":"Nelayan tradisional mendapatkan hasil lebih banyak"},"answer":"B","explanation":"Pukat harimau merusak habitat dasar laut (terumbu karang) dan memutus regenerasi ikan karena anak ikan ikut tertangkap."},{"id":6,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#d63031;'>[FUNGSI BAGIAN TUBUH HEWAN]</strong><br>Burung pelikan memiliki paruh yang berkantung besar.<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Fungsi ciri khusus tersebut adalah...</strong></div>","options":{"A":"Menyaring makanan dari lumpur","B":"Menyimpan makanan sementara (ikan)","C":"Mengoyak daging mangsanya","D":"Menghisap madu dari bunga"},"answer":"B","explanation":"Paruh berkantung pada pelikan berfungsi untuk menyedok ikan dari air dan menyimpannya sementara sebelum ditelan."},{"id":7,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#27ae60;'>[DAUR HIDUP HEWAN]</strong><br>Perhatikan tahapan daur hidup Nyamuk:<br>Telur -> (X) -> Pupa -> Nyamuk Dewasa<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Tahapan yang ditunjuk huruf X adalah...</strong></div>","options":{"A":"Nimfa (hidup di darat)","B":"Jentik-jentik/Tempayak (hidup di air)","C":"Ulat (memakan daun)","D":"Berudu (bernapas dengan insang)"},"answer":"B","explanation":"Setelah telur menetas, nyamuk menjadi larva (jentik-jentik) yang hidup di air sebelum menjadi pupa."},{"id":8,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Sendi yang memungkinkan gerakan ke <b>segala arah</b> (seperti pada gelang bahu dan gelang panggul) adalah...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Jenis sendi tersebut adalah...</strong></div>","options":{"A":"Sendi Engsel","B":"Sendi Pelana","C":"Sendi Peluru","D":"Sendi Putar"},"answer":"C","explanation":"Sendi peluru (Ball and Socket) memungkinkan gerakan bebas ke segala arah."},{"id":9,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#d63031;'>[SISTEM PERNAPASAN]</strong><br>Perhatikan fungsi organ pernapasan:<br>1. Menyaring debu halus<br>2. Mengatur kelembaban udara<br>3. Pertukaran O2 dan CO2<br>4. Menghubungkan hidung dengan paru-paru<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Fungsi Alveolus ditunjukkan nomor...</strong></div>","options":{"A":"1","B":"2","C":"3","D":"4"},"answer":"C","explanation":"Alveolus adalah gelembung halus di paru-paru tempat terjadinya pertukaran gas Oksigen (O2) dan Karbon Dioksida (CO2)."},{"id":10,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Benda-benda berikut dikelompokkan berdasarkan sifat bahannya:<br>1. Panci aluminium<br>2. Pegangan sodet kayu<br>3. Kawat tembaga<br>4. Kain wol</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Kelompok benda yang bersifat Isolator Panas adalah...</strong></div>","options":{"A":"1 dan 3","B":"1 dan 4","C":"2 dan 3","D":"2 dan 4"},"answer":"D","explanation":"Isolator adalah penghantar panas yang buruk. Kayu (2) dan Kain Wol (4) adalah isolator. Aluminium dan Tembaga adalah konduktor."},{"id":11,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Kapur barus (kamper) yang diletakkan di dalam lemari lama-kelamaan akan habis dan lemari menjadi harum.</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Perubahan wujud yang terjadi adalah...</strong></div>","options":{"A":"Menguap (Cair ke Gas)","B":"Mencair (Padat ke Cair)","C":"Menyublim (Padat ke Gas)","D":"Mengkristal (Gas ke Padat)"},"answer":"C","explanation":"Kapur barus adalah benda padat yang berubah langsung menjadi gas (harum) tanpa menjadi cair terlebih dahulu. Ini disebut menyublim."},{"id":12,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Saat memasang rel kereta api, selalu diberi celah antar sambungan batangnya. Hal ini bertujuan agar...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Alasan pemberian celah tersebut adalah...</strong></div>","options":{"A":"Rel tidak melengkung saat memuai di siang hari yang panas","B":"Rel tidak patah saat menyusut di malam hari","C":"Kereta api tidak anjlok saat mengerem mendadak","D":"Memudahkan pemasangan bantalan rel"},"answer":"A","explanation":"Logam memuai (bertambah panjang) saat panas. Celah dibuat untuk memberi ruang pemuaian agar rel tidak bengkok/melengkung."},{"id":13,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#0984e3;'>[PERPINDAHAN PANAS]</strong><br>Terjadinya angin darat dan angin laut merupakan contoh perpindahan panas secara...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Jenis perpindahan panas yang tepat adalah...</strong></div>","options":{"A":"Konduksi (melalui zat perantara padat)","B":"Konveksi (melalui aliran zat perantara gas/cair)","C":"Radiasi (pancaran tanpa zat perantara)","D":"Isolasi (penahanan panas)"},"answer":"B","explanation":"Angin terjadi karena aliran udara panas yang naik dan digantikan udara dingin. Perpindahan panas melalui aliran zat (udara) disebut Konveksi."},{"id":14,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Gaya yang bekerja saat kita mengerem sepeda hingga berhenti adalah...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Gaya tersebut adalah...</strong></div>","options":{"A":"Gaya Otot dan Gaya Gravitasi","B":"Gaya Gesek dan Gaya Otot","C":"Gaya Magnet dan Gaya Pegas","D":"Gaya Gravitasi dan Gaya Pegas"},"answer":"B","explanation":"Gaya Otot digunakan tangan untuk menekan rem. Gaya Gesek terjadi antara kampas rem dengan velg ban (atau ban dengan aspal) yang menahan laju."},{"id":15,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#e17055;'>[PERUBAHAN ENERGI]</strong><br>Saat kita menggunakan <b>Blender</b> dan <b>Solder</b>, perubahan energi yang terjadi berturut-turut adalah...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Urutan yang benar adalah...</strong></div>","options":{"A":"Listrik menjadi Gerak; Listrik menjadi Panas","B":"Listrik menjadi Bunyi; Listrik menjadi Cahaya","C":"Gerak menjadi Listrik; Panas menjadi Listrik","D":"Kimia menjadi Gerak; Kimia menjadi Panas"},"answer":"A","explanation":"Blender mengubah energi listrik menjadi energi gerak (memutar pisau). Solder mengubah energi listrik menjadi energi panas (melelehkan timah)."},{"id":16,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#0984e3;'>[SIFAT MAGNET]</strong><br>Cara membuat magnet dengan melilitkan kawat berarus listrik pada paku besi disebut...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Metode pembuatan magnet tersebut adalah...</strong></div>","options":{"A":"Induksi","B":"Gosokan","C":"Elektromagnet","D":"Konduksi"},"answer":"C","explanation":"Elektromagnet adalah magnet yang timbul karena aliran listrik pada kumparan kawat."},{"id":17,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#6c5ce7;'>[CIRI-CIRI PLANET]</strong><br>â€¢ Planet terbesar dalam tata surya<br>â€¢ Memiliki satelit terbanyak (Ganymede, Europa, dll)<br>â€¢ Kala rotasi tercepat<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Planet tersebut adalah...</strong></div>","options":{"A":"Saturnus","B":"Uranus","C":"Yupiter","D":"Neptunus"},"answer":"C","explanation":"Yupiter adalah planet terbesar (raksasa gas) dan memiliki rotasi yang sangat cepat (sekitar 10 jam)."},{"id":18,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Gerhana Matahari Total terjadi ketika posisi benda langit berada dalam satu garis lurus dengan urutan...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Urutan posisi yang benar adalah...</strong></div>","options":{"A":"Matahari - Bumi - Bulan","B":"Matahari - Bulan - Bumi","C":"Bumi - Matahari - Bulan","D":"Bulan - Matahari - Bumi"},"answer":"B","explanation":"Gerhana Matahari terjadi saat Bulan berada di antara Matahari dan Bumi, sehingga bayangan Bulan menutupi Bumi."},{"id":19,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#e17055;'>[DAUR AIR]</strong><br>Penebangan hutan secara liar dan pengaspalan jalan dapat mengganggu tahapan daur air, yaitu...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Tahapan yang terganggu adalah...</strong></div>","options":{"A":"Evaporasi (Penguapan air laut)","B":"Kondensasi (Pembentukan awan)","C":"Presipitasi (Turunnya hujan)","D":"Infiltrasi (Penyerapan air ke tanah)"},"answer":"D","explanation":"Hutan dan tanah terbuka berfungsi menyerap air. Jika diaspal atau gundul, air tidak meresap (Infiltrasi) tapi langsung mengalir (banjir), sehingga cadangan air tanah berkurang."},{"id":20,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#0984e3;'>[GERAKAN BUMI]</strong><br>Peristiwa akibat <b>Rotasi Bumi</b> (Bumi berputar pada porosnya) adalah...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Dampak yang benar adalah...</strong></div>","options":{"A":"Pergantian musim dan perbedaan lama siang-malam","B":"Terjadinya siang-malam dan perbedaan waktu","C":"Gerak semu tahunan matahari","D":"Terlihatnya rasi bintang yang berbeda"},"answer":"B","explanation":"Rotasi menyebabkan: Siang & Malam, Gerak Semu Harian (Matahari terbit-tenggelam), dan Perbedaan Waktu. (Opsi A, C, D adalah akibat Revolusi)."},{"id":21,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#6c5ce7;'>[SKEMA GERHANA]</strong><br>Posisi: Matahari - Bumi - Bulan berada dalam satu garis lurus.<br>Bulan berada di area bayangan inti (Umbra) Bumi.<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Peristiwa yang terjadi adalah...</strong></div>","options":{"A":"Gerhana Bulan Total","B":"Gerhana Bulan Sebagian","C":"Gerhana Matahari Total","D":"Gerhana Matahari Cincin"},"answer":"A","explanation":"Jika Bulan masuk sepenuhnya ke dalam bayangan inti (Umbra) Bumi, maka terjadi Gerhana Bulan Total."},{"id":22,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Tahapan daur hidup kupu-kupu yang <b>merugikan petani</b> karena memakan daun tanaman adalah...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Tahapan tersebut adalah...</strong></div>","options":{"A":"Telur","B":"Larva (Ulat)","C":"Pupa (Kepompong)","D":"Imago (Kupu-kupu dewasa)"},"answer":"B","explanation":"Fase Larva (ulat) sangat rakus memakan daun untuk pertumbuhan, sehingga sering menjadi hama bagi petani."},{"id":23,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#0984e3;'>[GAMBAR RANGKAIAN LISTRIK]</strong><br>Rangkaian campuran dengan 3 Lampu (L1, L2, L3) dan 2 Sakelar (S1, S2).<br>â€¢ S1 mengatur L1.<br>â€¢ S2 mengatur L2 dan L3.<br><br><b>Kondisi:</b> Sakelar S1 disambung (ON), Sakelar S2 diputus (OFF).<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Keadaan lampu yang tepat adalah...</strong></div>","options":{"A":"L1 padam, L2 dan L3 menyala","B":"L1 menyala, L2 dan L3 padam","C":"Semua lampu menyala","D":"Semua lampu padam"},"answer":"B","explanation":"Karena S1 ON, arus mengalir ke L1 (Menyala). Karena S2 OFF, arus putus ke L2 & L3 (Padam)."},{"id":24,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Para petani di daerah miring (pegunungan) membuat lahan pertanian dengan sistem <b>Terasering</b> (bertingkat).</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Tujuan utama sistem tersebut adalah...</strong></div>","options":{"A":"Mempermudah saat panen raya","B":"Menambah keindahan pemandangan","C":"Mencegah tanah longsor dan erosi","D":"Menyimpan air hujan lebih banyak"},"answer":"C","explanation":"Terasering mengurangi laju aliran air dari atas ke bawah sehingga mencegah pengikisan tanah (erosi) dan longsor."},{"id":25,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#e17055;'>[PERUBAHAN WUJUD]</strong><br>Terbentuknya titik-titik air (embun) pada bagian luar gelas yang berisi es teh merupakan contoh peristiwa...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Peristiwa tersebut disebut...</strong></div>","options":{"A":"Menguap","B":"Mencair","C":"Mengembun","D":"Menyublim"},"answer":"C","explanation":"Uap air di udara (gas) bersentuhan dengan dinding gelas dingin, melepaskan kalor, dan berubah menjadi titik air (cair) = Mengembun."},{"id":26,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Fungsi utama <b>Jantung</b> pada tubuh manusia adalah...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Fungsi tersebut adalah...</strong></div>","options":{"A":"Menyaring darah dari racun","B":"Memompa darah ke seluruh tubuh","C":"Tempat pertukaran oksigen dan karbondioksida","D":"Menghasilkan sel darah merah"},"answer":"B","explanation":"Jantung berfungsi sebagai alat pemompa darah agar dapat mengalir ke seluruh bagian tubuh."},{"id":27,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#0984e3;'>[SIFAT CAHAYA]</strong><br>Kita dapat melihat bayangan wajah kita saat bercermin di depan kaca rias.<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Peristiwa ini membuktikan bahwa cahaya dapat...</strong></div>","options":{"A":"Dibiaskan","B":"Dipantulkan","C":"Diuraikan","D":"Menembus benda bening"},"answer":"B","explanation":"Cermin memantulkan cahaya yang mengenainya sehingga terbentuk bayangan (Pemantulan teratur)."},{"id":28,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Upaya pelestarian <b>Orang Utan</b> yang habitatnya semakin sempit akibat pembukaan lahan sawit dapat dilakukan dengan cara...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Upaya yang paling tepat adalah...</strong></div>","options":{"A":"Membuat penangkaran di kebun binatang kota","B":"Mendirikan pusat rehabilitasi dan suaka margasatwa","C":"Memindahkan orang utan ke pulau lain","D":"Menanam pohon sawit lebih banyak"},"answer":"B","explanation":"Pusat rehabilitasi (seperti di Tanjung Puting) membantu Orang Utan beradaptasi kembali sebelum dilepasliarkan di habitat aslinya (Suaka Margasatwa)."},{"id":29,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#6c5ce7;'>[SUMBER ENERGI ALTERNATIF]</strong><br>Energi alternatif yang memanfaatkan <b>kotoran hewan ternak</b> (sapi/kerbau) yang difermentasi disebut...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Energi tersebut adalah...</strong></div>","options":{"A":"Biodiesel","B":"Bioetanol","C":"Biogas","D":"Biosolar"},"answer":"C","explanation":"Biogas adalah gas metana yang dihasilkan dari fermentasi limbah organik (kotoran hewan) dan bisa dipakai untuk memasak."},{"id":30,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Dasar perhitungan <b>Kalender Hijriah</b> (Komariah) adalah...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Dasar perhitungannya adalah...</strong></div>","options":{"A":"Rotasi Bumi","B":"Revolusi Bumi","C":"Rotasi Bulan","D":"Revolusi Bulan"},"answer":"D","explanation":"Kalender Hijriah didasarkan pada peredaran Bulan mengelilingi Bumi (Revolusi Bulan). Sedangkan Masehi berdasarkan Revolusi Bumi."},{"id":31,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Perhatikan ciri-ciri masa pubertas berikut!<br>1. Suara menjadi berat (jakun tumbuh)<br>2. Pinggul membesar<br>3. Dada membidang<br>4. Mengalami menstruasi<br>5. Tumbuh rambut halus di ketiak</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Ciri fisik pubertas pada Laki-laki ditunjukkan nomor...</strong></div>","options":{"A":"1, 2, dan 5","B":"1, 3, dan 5","C":"2, 3, dan 4","D":"2, 4, dan 5"},"answer":"B","explanation":"Ciri laki-laki: Suara berat, dada bidang, tumbuh rambut halus. (Pinggul membesar dan menstruasi adalah ciri perempuan)."},{"id":32,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#0984e3;'>[PERKEMBANGBIAKAN TUMBUHAN]</strong><br>Tumbuhan <b>Pisang</b> dan <b>Bambu</b> berkembang biak dengan cara yang sama, yaitu...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Cara perkembangbiakan tersebut adalah...</strong></div>","options":{"A":"Rizoma (Akar tinggal)","B":"Stolon (Geragih)","C":"Tunas","D":"Tunas Adventif"},"answer":"C","explanation":"Pisang dan Bambu berkembang biak dengan Tunas yang tumbuh dari pangkal batang induknya."},{"id":33,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Bahan yang cocok untuk membuat <b>Pegangan Setrika</b> adalah...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Bahan dan alasannya yang tepat adalah...</strong></div>","options":{"A":"Besi, karena kuat dan tahan panas","B":"Plastik/Ebonit, karena bersifat isolator (tidak menghantar panas)","C":"Aluminium, karena ringan dan mengkilap","D":"Karet, karena lentur dan elastis"},"answer":"B","explanation":"Pegangan setrika harus terbuat dari Isolator (Plastik keras/Ebonit/Kayu) agar tangan pengguna tidak kepanasan."},{"id":34,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><strong style='color:#e17055;'>[GAYA DAN GERAK]</strong><br>Kegiatan membuat gerabah dari tanah liat menunjukkan bahwa gaya dapat...<hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Pengaruh gaya tersebut adalah...</strong></div>","options":{"A":"Mengubah arah gerak benda","B":"Mengubah benda diam menjadi bergerak","C":"Mengubah bentuk benda","D":"Mengubah kecepatan benda"},"answer":"C","explanation":"Menekan tanah liat hingga menjadi pot/guci adalah bukti gaya dapat mengubah bentuk benda."},{"id":35,"type":"pg","question":"<div style='background:#ffffff; color:#2d3436; padding:20px; border-radius:15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid #e0e0e0; font-family: sans-serif;'><p>Simbiosis antara <b>Lebah</b> dan <b>Bunga</b> termasuk simbiosis mutualisme karena...</p><hr style='border:0; border-top:1px dashed #ccc; margin:15px 0;'><strong style='font-size:1.1em; color:#000;'>Alasan yang tepat adalah...</strong></div>","options":{"A":"Lebah mendapat nektar, Bunga dibantu penyerbukannya","B":"Lebah mendapat tempat tinggal, Bunga tidak dirugikan","C":"Lebah memakan kelopak bunga, Bunga dirugikan","D":"Lebah melindungi bunga dari hama, Bunga memberi nektar"},"answer":"A","explanation":"Mutualisme = Saling menguntungkan. Lebah kenyang dapat madu/nektar, Bunga untung karena serbuk sarinya disebarkan lebah (penyerbukan)."}];
    let idx = 0;
    let answers = {};
    let time = 7200;
    let timerInt;
    let isShuffled = false;
    const els = {};

        
    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }
    
    function showFb(txt) {
        els.txt.fb.innerHTML = txt;
        els.box.fb.classList.remove('hidden');
    }

    function toggleMap() {
        els.scr.map.classList.toggle('hidden');
        renderMap();
    }

        
    function renderQ() {
        const d = quizData[idx];
        const saved = answers[d.id];
        
        const card = document.getElementById('questionCard');
        if(card) {
            card.style.animation = 'none';
            card.offsetHeight;
            card.style.animation = 'fadein 0.3s ease-out';
        }

        els.box.content.innerHTML = '';
        els.box.fb.classList.add('hidden');
        els.txt.qNum.innerText = (idx+1) + ' / ' + quizData.length;
        
        // Handle Image
        let imgHTML = '';
        if(d.image) {
            imgHTML = '<div style="margin-bottom:1.5rem; border-radius:1rem; overflow:hidden; border:1px solid rgba(255,255,255,0.1); background:rgba(0,0,0,0.2); box-shadow: 0 4px 15px rgba(0,0,0,0.3);">' +
                      '<img src="' + d.image + '" style="width:100%; height:auto; display:block; max-height:400px; object-fit:contain; margin:0 auto;" alt="Visual Soal">' +
                      '</div>';
        }
        els.txt.qText.innerHTML = imgHTML + d.question;
        
        const badge = document.getElementById('qTypeBadge');
        if(d.type === 'pg') { badge.className = 'badge badge-pg'; badge.innerText = 'Pilihan Ganda'; }
        else if(d.type === 'pg-complex') { badge.className = 'badge badge-complex'; badge.innerText = 'Pilihan Ganda Kompleks'; }
        else if(d.type === 'match') { badge.className = 'badge badge-match'; badge.innerText = 'Menjodohkan'; }
        else { badge.className = 'badge badge-mix'; badge.innerText = 'Uraian'; }

        if(d.type === 'pg') renderPG(d, saved);
        else if(d.type === 'pg-complex') renderPGComplex(d, saved);
        else if(d.type === 'match') renderMatch(d, saved);
        else renderText(d, saved);

        els.btns.prev.disabled = idx === 0;
        if(idx === quizData.length-1) {
            els.btns.next.classList.add('hidden');
            els.btns.fin.classList.remove('hidden');
        } else {
            els.btns.next.classList.remove('hidden');
            els.btns.fin.classList.add('hidden');
        }

        els.bar.style.width = ((idx+1)/quizData.length)*100 + '%';
        els.txt.ansCount.innerText = Object.keys(answers).length;
        renderMap();
    }

    function renderMap() {
        els.box.map.innerHTML = '';
        quizData.forEach((q, i) => {
            const b = document.createElement('button');
            b.className = 'map-btn ' + (i===idx ? 'active ' : '') + (answers[q.id] ? 'answered' : '');
            b.innerText = i+1;
            b.onclick = () => { idx = i; renderQ(); els.scr.map.classList.add('hidden'); };
            els.box.map.appendChild(b);
        });
    }

    function renderPG(d, s) {
        Object.entries(d.options || {}).forEach(([k,v]) => {
            const b = document.createElement('button');
            b.className = 'btn-option';
            b.style.padding = '1.1rem';
            b.style.borderRadius = '1rem';
            let icon = '';
            
            if(s) {
                if(k == d.answer) { b.classList.add('correct'); icon = 'âœ“'; }
                else if(s.val == k && k != d.answer) { b.classList.add('wrong'); icon = 'âœ•'; }
            } else {
                b.onclick = () => { answers[d.id] = { val: k, score: k==d.answer ? 1 : 0 }; renderQ(); };
            }
            
            b.innerHTML = '<b class="option-icon" style="width:24px; height:24px;">' + k + '</b> <span style="flex:1" dir="auto">' + v + '</span> <b>' + icon + '</b>';
            els.box.content.appendChild(b);
        });
        if(s) showFb(d.explanation);
    }

    function renderPGComplex(d, s) {
        let currentVal = (s && s.val) ? s.val : (answers[d.id] ? answers[d.id].val : []);
        if(!Array.isArray(currentVal)) currentVal = [];

        Object.entries(d.options || {}).forEach(([k,v]) => {
            const b = document.createElement('button');
            b.className = 'btn-option checkbox';
            b.style.padding = '1.1rem';
            b.style.borderRadius = '1rem';
            let icon = '';
            
            if(s && s.score !== undefined) {
                const isSelected = currentVal.includes(k);
                const isCorrectKey = d.answer.includes(k);
                if(isCorrectKey) { 
                    b.classList.add('correct'); icon = 'âœ“'; 
                    if(!isSelected) b.classList.add('missed');
                } else if (isSelected && !isCorrectKey) {
                    b.classList.add('wrong'); icon = 'âœ•';
                } else if (isSelected) b.classList.add('correct');
            } else {
                if(currentVal.includes(k)) { b.style.borderColor = 'var(--primary)'; b.style.background = 'rgba(99, 102, 241, 0.2)'; }
                b.onclick = () => {
                    const newSet = currentVal.includes(k) ? currentVal.filter(x => x !== k) : [...currentVal, k];
                    answers[d.id] = { val: newSet }; renderQ(); 
                };
            }
            const boxContent = currentVal.includes(k) ? 'âœ“' : k;
            b.innerHTML = '<b class="option-icon" style="width:24px; height:24px; border-radius: 6px;">' + boxContent + '</b> <span style="flex:1" dir="auto">' + v + '</span> <b>' + icon + '</b>';
            els.box.content.appendChild(b);
        });

        if(!s || s.score === undefined) {
             const btn = document.createElement('button');
             btn.className = 'btn btn-primary'; btn.innerText = 'KONFIRMASI JAWABAN'; btn.style.marginTop = '1rem';
             btn.style.padding = '1rem'; btn.style.borderRadius = '1rem';
             btn.onclick = () => {
                 const currentVal = answers[d.id]?.val || [];
                 if(currentVal.length === 0) return alert('Pilih minimal satu jawaban!');
                 const sortedKey = [...d.answer].sort();
                 const sortedUser = [...currentVal].sort();
                 const isCorrect = JSON.stringify(sortedKey) === JSON.stringify(sortedUser);
                 answers[d.id] = { val: currentVal, score: isCorrect ? 1 : 0 }; renderQ();
             };
             els.box.content.appendChild(btn);
        } else { showFb(d.explanation); }
    }

    function renderMatch(d, s) {
        let opts = (d.items || []).map(i => i.m);
        if(!s) opts.sort(() => Math.random() - 0.5); 

        (d.items || []).forEach((item, i) => {
            const row = document.createElement('div'); row.className = 'match-row';
            row.style.borderRadius = '1rem'; row.style.padding = '1rem';
            let inner = '<div style="font-size:0.95rem; margin-bottom:0.5rem; font-weight:700;" dir="auto">' + (i+1) + '. ' + item.t + '</div>';
            
            if(s) {
                const userVal = s.pairs[i]; const correct = userVal === item.m; const color = correct ? 'var(--success)' : 'var(--danger)';
                inner += '<div style="border:1px solid ' + color + '; color:' + color + '; padding:0.75rem; border-radius:0.75rem; font-size:0.9rem; font-weight:700;">Jawaban: ' + (userVal || '-') + ' ' + (correct ? 'âœ“' : 'âœ•') + '</div>';
                if(!correct) inner += '<div style="font-size:0.8rem; color:var(--success); margin-top:5px; font-weight:600;">Kunci: ' + item.m + '</div>';
            } else {
                inner += '<select id="match_' + i + '" style="border-radius:0.75rem; padding:0.75rem;"><option value="" disabled selected>Pilih Pasangan...</option>';
                opts.forEach(o => inner += '<option value="' + o + '">' + o + '</option>');
                inner += '</select>';
            }
            row.innerHTML = inner; els.box.content.appendChild(row);
        });

        if(!s) {
            const btn = document.createElement('button'); btn.className = 'btn btn-primary'; btn.innerText = 'KUNCI PASANGAN'; btn.style.marginTop = '1rem';
            btn.style.padding = '1rem'; btn.style.borderRadius = '1rem';
            btn.onclick = () => {
                let pairs = {}; let correctCount = 0; let filled = true;
                (d.items || []).forEach((item, i) => {
                    const val = document.getElementById('match_' + i).value;
                    if(!val) filled = false; pairs[i] = val; if(val === item.m) correctCount++;
                });
                if(!filled) return alert('Lengkapi semua pasangan!');
                answers[d.id] = { pairs: pairs, score: correctCount/(d.items || []).length }; renderQ();
            };
            els.box.content.appendChild(btn);
        } else { showFb(d.explanation); }
    }

    function renderText(d, s) {
        if(!s) {
            const txt = document.createElement('textarea'); txt.id = 'essay_input_' + d.id; txt.rows = 4; txt.placeholder = 'Ketik jawaban Anda di sini...'; txt.dir = "auto";
            txt.style.borderRadius = '1rem'; txt.style.padding = '1rem';
            const btn = document.createElement('button'); btn.className = 'btn btn-primary'; btn.innerText = 'LIHAT KUNCI'; btn.style.marginTop = '1rem';
            btn.style.padding = '1rem'; btn.style.borderRadius = '1rem';
            btn.onclick = () => {
                const t = document.getElementById('essay_input_' + d.id); if(!t.value.trim()) return alert('Tuliskan jawaban terlebih dahulu!');
                t.disabled = true; btn.classList.add('hidden'); document.getElementById('selfEval').classList.remove('hidden');
            };
            els.box.content.append(txt, btn);

            const evalDiv = document.createElement('div'); evalDiv.id = 'selfEval'; evalDiv.className = 'hidden';
            let h = '<div style="background:rgba(0,0,0,0.5); padding:1.25rem; border-radius:1rem; border:2px solid var(--success); margin-top:1rem;"><b style="color:var(--success); font-size:0.75rem; text-transform:uppercase; letter-spacing:1px; display:block; margin-bottom:0.5rem;">KUNCI JAWABAN:</b><div style="font-size:1rem; color:white; font-weight:700;" dir="auto">' + d.answer + '</div></div>';
            h += '<div style="text-align:center; margin-top:1rem; font-size:0.8rem; font-weight:800; color:var(--text-muted); text-transform:uppercase;">Evaluasi Jawaban Anda:</div>';
            h += '<div class="flex gap-3 mt-3">';
            h += '<button class="btn" style="flex:1; background:rgba(239,68,68,0.15); border:1px solid var(--danger); font-size:0.8rem; border-radius:1rem; padding:0.8rem;" onclick="rate(' + d.id + ', 0)">SALAH</button>';
            h += '<button class="btn" style="flex:1; background:rgba(245,158,11,0.15); border:1px solid var(--warning); font-size:0.8rem; border-radius:1rem; padding:0.8rem;" onclick="rate(' + d.id + ', 0.5)">MIRIP</button>';
            h += '<button class="btn" style="flex:1; background:rgba(16,185,129,0.15); border:1px solid var(--success); font-size:0.8rem; border-radius:1rem; padding:0.8rem;" onclick="rate(' + d.id + ', 1)">BENAR</button>';
            h += '</div>';
            evalDiv.innerHTML = h;
            
            window.rate = (id, sc) => { const t = document.getElementById('essay_input_' + id); answers[id] = { ans: t ? t.value : '-', score: sc }; renderQ(); };
            els.box.content.appendChild(evalDiv);
        } else {
            els.box.content.innerHTML = '<div style="background:rgba(15,23,42,0.8); padding:1rem; border-radius:1rem; margin-bottom:1rem; font-style:italic; font-size:0.95rem; border:1px solid rgba(255,255,255,0.05);" dir="auto">"' + s.ans + '"</div><div style="text-align:center; padding:0.75rem; border:2px solid ' + (s.score==1? 'var(--success)' : (s.score==0.5?'var(--warning)':'var(--danger)')) + '; border-radius:0.75rem; font-weight:900; background:rgba(0,0,0,0.2);">NILAI MANDIRI: ' + s.score + '</div><div style="margin-top:1rem; font-size:0.9rem; background:rgba(255,255,255,0.02); padding:1rem; border-radius:1rem;"><b style="color:var(--success); text-transform:uppercase; font-size:0.7rem; display:block; margin-bottom:0.25rem;">Kunci:</b> <div style="font-weight:700; color:white;" dir="auto">' + d.answer + '</div></div>';
            showFb(d.explanation);
        }
    }

        
    function startQuiz() {
        try {
            if(els.scr.start) els.scr.start.classList.add('hidden');
            if(els.scr.app) { els.scr.app.classList.remove('hidden'); els.scr.app.classList.add('flex'); }
            renderQ();
            if(time > 0) timerInt = setInterval(tick, 1000);
        } catch(e) {
            console.error("Error starting quiz:", e);
            document.getElementById('startModal').style.display = 'none';
            document.getElementById('appContainer').style.display = 'flex';
            renderQ();
        }
    }

    function tick() {
        time--;
        const h = Math.floor(time/3600).toString().padStart(2,'0');
        const m = Math.floor((time%3600)/60).toString().padStart(2,'0');
        const s = (time%60).toString().padStart(2,'0');
        if(els.txt.timer) els.txt.timer.innerText = h + ':' + m + ':' + s;
        if(time<=0) finishQuiz();
    }
    
    function nextQ() { if(idx < quizData.length-1) { idx++; renderQ(); } }
    function prevQ() { if(idx > 0) { idx--; renderQ(); } }

    function finishQuiz() {
        clearInterval(timerInt);
        let sc = 0; let cor = 0; let wr = 0; let oth = 0;
        
        quizData.forEach(q => {
            const a = answers[q.id];
            if(a) {
                sc += (a.score || 0);
                if(q.type === 'pg' || q.type === 'pg-complex') { if(a.score === 1) cor++; else wr++; } 
                else { oth += (a.score || 0); }
            } else if(q.type === 'pg' || q.type === 'pg-complex') wr++;
        });

        const final = Math.round((sc / quizData.length) * 100);
        document.getElementById('finalScore').innerText = final;
        document.getElementById('finalPred').innerText = final >= 80 ? 'Sangat Baik' : (final >= 70 ? 'Baik' : 'Cukup');
        document.getElementById('resCorrect').innerText = cor;
        document.getElementById('resWrong').innerText = wr;
        document.getElementById('resEssay').innerText = oth.toFixed(1);

        els.scr.app.classList.add('hidden');
        els.scr.res.classList.remove('hidden');
        
        for(let i=0; i<50; i++) {
            const c = document.createElement('div'); c.className = 'confetti';
            c.style.left = Math.random()*100 + 'vw'; c.style.backgroundColor = ['#f00','#0f0','#00f','#ff0'][Math.floor(Math.random()*4)];
            c.style.animationDuration = (Math.random()*2+2) + 's'; document.body.appendChild(c);
        }
    }

    async function drawScoreCard(score, grade, correct, wrong, title) {
        const canvas = document.createElement('canvas'); canvas.width = 800; canvas.height = 400; const ctx = canvas.getContext('2d');
        const grd = ctx.createLinearGradient(0,0, 800, 400);
        grd.addColorStop(0, getComputedStyle(document.body).getPropertyValue('--bg-dark').trim() || '#0f172a'); grd.addColorStop(1, '#000000');
        ctx.fillStyle = grd; ctx.fillRect(0,0, 800, 400);

        ctx.beginPath(); ctx.arc(400, 140, 80, 0, 2 * Math.PI); ctx.fillStyle = 'rgba(255,255,255,0.05)'; ctx.fill();
        ctx.lineWidth = 4; ctx.strokeStyle = getComputedStyle(document.body).getPropertyValue('--primary').trim() || '#6366f1'; ctx.stroke();

        ctx.fillStyle = '#ffffff'; ctx.textAlign = 'center';
        ctx.font = 'bold 24px sans-serif'; ctx.fillText(title.substring(0,30) + (title.length>30?'...':''), 400, 40);
        ctx.font = 'bold 80px sans-serif'; ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--primary').trim() || '#6366f1'; ctx.fillText(score, 400, 165);
        ctx.font = 'bold 30px sans-serif'; ctx.fillStyle = '#ffffff'; ctx.fillText(grade, 400, 260);
        ctx.font = '20px sans-serif'; ctx.fillStyle = '#94a3b8'; ctx.fillText('âœ… Benar: ' + correct + '   âŒ Salah: ' + wrong, 400, 310);
        
        // Dynamic Branding Watermark
        ctx.font = 'italic 16px sans-serif'; ctx.fillStyle = 'rgba(255,255,255,0.3)'; ctx.fillText('Powered by ' + brand + ' ' + footer, 400, 350);
        ctx.font = 'bold 12px sans-serif'; ctx.fillText('Hubungi Kami: 6285643573687', 400, 375);
        return new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
    }

    async function shareResult() {
        const btn = els.btns.share; const originalText = btn.innerText; btn.innerText = 'WAIT...'; btn.disabled = true;
        try {
            let correct = 0; const score = document.getElementById('finalScore').innerText; const total = quizData.length; const grade = document.getElementById('finalPred').innerText;
            Object.values(answers).forEach(a => { if(a.score === 1) correct++; });
            
            // Dynamic Branding prefix for sharing
            const text = [ 
                'ðŸ† *HASIL KUIS @ MAFIA QUIZ*', 
                'Kuis: *SIAP LIBAS ASPD DIY SD*', 
                'â­ Skor: ' + score + ' (' + grade + ')', 
                'âœ… Benar: ' + correct + ' | âŒ Salah: ' + (total - correct), 
                '', 
                'Mau belajar dengan kuis lain? Pesan di Mafia Quiz:', 
                'https://wa.me/6285643573687' 
            ].join('\n');

            const blob = await drawScoreCard(score, grade, correct, total-correct, 'SIAP LIBAS ASPD DIY SD');
            const file = new File([blob], 'score.png', { type: 'image/png' });

            // 1. Try System Share (Best for Mobile)
            if(navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) { 
                await navigator.share({ files: [file], text: text }); 
            } 
            // 2. Try System Share Text Only
            else if(navigator.share) { 
                await navigator.share({ title: 'SIAP LIBAS ASPD DIY SD', text: text }); 
            } 
            // 3. Fallback: Open WhatsApp Directly + Clipboard
            else {
                navigator.clipboard.writeText(text);
                const waUrl = "https://wa.me/?text=" + encodeURIComponent(text);
                window.open(waUrl, '_blank');
                alert('Teks hasil telah disalin! Silakan tempel di WhatsApp.');
            }
        } catch(err) {
            console.log('Share failed', err);
            // Last resort manual open
            const score = document.getElementById('finalScore').innerText;
            const waUrl = "https://wa.me/?text=" + encodeURIComponent('ðŸ† Skor Kuis Saya: ' + score + ' @ Mafia Quiz');
            window.open(waUrl, '_blank');
        } finally { btn.innerText = originalText; btn.disabled = false; }
    }

        
    function init() {
        els.scr = { start: document.getElementById('startModal'), app: document.getElementById('appContainer'), res: document.getElementById('resultModal'), map: document.getElementById('mapModal') };
        els.txt = { qNum: document.getElementById('qNumber'), qText: document.getElementById('qText'), timer: document.getElementById('timerDisplay'), ansCount: document.getElementById('answeredCount'), fb: document.getElementById('feedbackText') };
        els.box = { content: document.getElementById('qContent'), fb: document.getElementById('feedbackContainer'), map: document.getElementById('mapGrid') };
        els.bar = document.getElementById('progressBar');
        els.btns = { prev: document.getElementById('btnPrev'), next: document.getElementById('btnNext'), fin: document.getElementById('btnFinish'), start: document.getElementById('btnStartQuiz'), share: document.getElementById('btnShareApp') };

        if(els.btns.start) { els.btns.start.onclick = startQuiz; } 
        else { const btn = document.querySelector('button[onclick="startQuiz()"]'); if(btn) btn.onclick = startQuiz; }

        if(els.btns.share) els.btns.share.onclick = shareResult;
        if(isShuffled) shuffleArray(quizData);
    }
    window.onload = init;

    </script>

</body>
</html>